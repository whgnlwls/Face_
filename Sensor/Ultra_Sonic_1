#include <wiringPi.h>
#include <stdio.h>

#define US1_trig 28
#define US1_echo 27

void setup() {
	pinMode(US1_trig, OUTPUT) ;
	pinMode(US1_echo , INPUT) ;
}

float getDist() {
	float distance;
	int throw_time, catch_time;
	
	while(1) {
	digitalWrite(US1_trig, LOW);
    delay(500);
    digitalWrite(US1_trig, HIGH);
    delayMicroseconds(10);
    digitalWrite(US1_trig, LOW);
    
    while (digitalRead(US1_echo) == 0);
    
    throw_time = micros();
    while (digitalRead(US1_echo) == 1);
    catch_time = micros();
    
    distance = (catch_time - throw_time) / 29. / 2.;
    printf("distance %.2f cm\n", distance);
	}
}

int main ()
{
	if (wiringPiSetup() == -1) return -1 ;
	
	setup();
	getDist();
  
	return 0;
}
